<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Data &mdash; giotto-deep 0.0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Models" href="models.html" />
    <link rel="prev" title="BERT" href="bert.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> giotto-deep
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="analysis.html">Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="bert.html">BERT</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="pipeline.html">Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="search.html">Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="topology_layers.html">Topology Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="utility.html">Utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualisation.html">Visualisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#references">References</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">giotto-deep</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">API reference</a> &raquo;</li>
      <li>Data</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/modules/data.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-gdeep.data">
<span id="data"></span><h1>Data<a class="headerlink" href="#module-gdeep.data" title="Permalink to this headline"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.AbstractPreprocessing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">AbstractPreprocessing</span></span><a class="headerlink" href="#gdeep.data.AbstractPreprocessing" title="Permalink to this definition"></a></dt>
<dd><p>The abstract class to define the interface of preprocessing</p>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.AbstractPreprocessing.fit_to_data">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit_to_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.AbstractPreprocessing.fit_to_data" title="Permalink to this definition"></a></dt>
<dd><p>This method deals with getting dataset-level information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.AbstractPreprocessing.transform">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.AbstractPreprocessing.transform" title="Permalink to this definition"></a></dt>
<dd><p>This method deals with datum-wise transformations. This
method is called in the Datasets to transform the output
of <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.CreateToriDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">CreateToriDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.CreateToriDataset" title="Permalink to this definition"></a></dt>
<dd><p>This class is used to generate data loaders for the
family of tori-datasets</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>name (string):</dt><dd><p>name of the torus dataset to generate</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.CreateToriDataset.generate_dataset">
<span class="sig-name descname"><span class="pre">generate_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.CreateToriDataset.generate_dataset" title="Permalink to this definition"></a></dt>
<dd><p>This method is the maion method of the class.
It generates the ToriDatasset class depending on
the self.name</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.DataLoaderFromArray">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">DataLoaderFromArray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.DataLoaderFromArray" title="Permalink to this definition"></a></dt>
<dd><p>This class is useful to build dataloaders
from a array of X and y. Tensors are also supported.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>X_train (np.array):</dt><dd><p>The training data</p>
</dd>
<dt>y_train (np.array):</dt><dd><p>The training labels</p>
</dd>
<dt>X_val (np.array):</dt><dd><p>The validation data</p>
</dd>
<dt>y_val (np.array):</dt><dd><p>The validation labels</p>
</dd>
<dt>X_test (np.array):</dt><dd><p>The test data</p>
</dd>
<dt>labels_file (string):</dt><dd><p>The path and file name of the labels.
It shall be a csv file with two columns.
The first columns contains the name of the
image and the second one contains the
label value</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.DataLoaderFromArray.build_dataloaders">
<span class="sig-name descname"><span class="pre">build_dataloaders</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="headerlink" href="#gdeep.data.DataLoaderFromArray.build_dataloaders" title="Permalink to this definition"></a></dt>
<dd><p>This method builds the dataloader.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>kwargs (dict):</dt><dd><p>additional arguments to pass to the
DataLoaders</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple of torch.DataLoader:</dt><dd><p>the tuple with the training, validation and
test dataloader directly usable in
the pipeline class</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.DataLoaderFromImages">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">DataLoaderFromImages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'labels.csv'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.DataLoaderFromImages" title="Permalink to this definition"></a></dt>
<dd><p>This class is useful to build dataloaders
from different images you have in a folder</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>training_folder (string):</dt><dd><p>The path to the folder where the training
images are located</p>
</dd>
<dt>test_folder (string):</dt><dd><p>The path to the folder where the
test images are located</p>
</dd>
<dt>labels_file (string):</dt><dd><p>The path and file name of the labels.
It shall be a csv file with two columns.
The first columns contains the name of the
image and the second one contains the
label value</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.DataLoaderFromImages.build_dataloaders">
<span class="sig-name descname"><span class="pre">build_dataloaders</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(128,</span> <span class="pre">128)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="headerlink" href="#gdeep.data.DataLoaderFromImages.build_dataloaders" title="Permalink to this definition"></a></dt>
<dd><p>This method builds the dataloader.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>size (tuple):</dt><dd><p>a tuple (h,w) to convert all images
to the same size</p>
</dd>
<dt>kwargs (dict):</dt><dd><p>additional arguments to pass to the
DataLoaders</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple of torch.DataLoader:</dt><dd><p>the tuple with thhe training and
test dataloader directly usable in
the pipeline class</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.DataLoaderKwargs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">DataLoaderKwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_kwargs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_kwargs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.DataLoaderKwargs" title="Permalink to this definition"></a></dt>
<dd><p>Object to store keyword arguments for train, val, and test dataloaders</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.DatasetCloud">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">DatasetCloud</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bucket_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'adversarial_attack'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">download_directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_public_access</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_credentials</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">make_public</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.DatasetCloud" title="Permalink to this definition"></a></dt>
<dd><p>DatasetCloud class to handle the download and upload
of datasets to the DataCloud.
If the download_directory does not exist, it will be created and
if a folder with the same name as the dataset exists in the
download directory, it will not be downloaded again.
If a folder with the same name as the dataset does not exists
locally, it will be created when downloading the dataset.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>dataset_name (str):</dt><dd><p>Name of the dataset to be downloaded or uploaded.</p>
</dd>
<dt>bucket_name (str, optional):</dt><dd><p>Name of the bucket in the DataCloud.
Defaults to DATASET_BUCKET_NAME.</p>
</dd>
<dt>download_directory (Union[None, str], optional):</dt><dd><p>Directory where the
dataset will be downloaded to. Defaults to DEFAULT_DOWNLOAD_DIR.</p>
</dd>
<dt>use_public_access (bool, optional):</dt><dd><p>If True, the dataset will
downloaded via public url. Defaults to False.</p>
</dd>
<dt>path_credentials (Union[None, str], optional):</dt><dd><p>Path to the credentials file.
Only used if public_access is False and credentials are not
provided. Defaults to None.</p>
</dd>
<dt>make_public (bool, optional):</dt><dd><p>If True, the dataset will be made public</p>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>ValueError:</dt><dd><p>Dataset does not exits in cloud.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.DatasetCloud.download">
<span class="sig-name descname"><span class="pre">download</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#gdeep.data.DatasetCloud.download" title="Permalink to this definition"></a></dt>
<dd><p>Download a dataset from the DataCloud. If the dataset does not
exist in the cloud, an exception will be raised. If the dataset
exists locally in the download directory, the dataset will not be
downloaded again.</p>
<dl class="simple">
<dt>Raises:</dt><dd><dl class="simple">
<dt>ValueError:</dt><dd><p>Dataset does not exits in cloud.</p>
</dd>
<dt>ValueError:</dt><dd><p>Dataset exists locally but checksums do not match.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.DatasetCloud.get_existing_datasets">
<span class="sig-name descname"><span class="pre">get_existing_datasets</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.DatasetCloud.get_existing_datasets" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of datasets in the cloud.</p>
<dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>List[str]:</dt><dd><p>List of datasets in the cloud.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.DlBuilderFromDataCloud">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">DlBuilderFromDataCloud</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">download_directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_public_access</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_credentials</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.DlBuilderFromDataCloud" title="Permalink to this definition"></a></dt>
<dd><p>Class that loads data from Google Cloud Storage</p>
<p>This class is useful to build dataloaders from a dataset stored in
the GDeep Dataset Cloud on Google Cloud Storage.</p>
<p>The constructor takes the name of a dataset as a string, and a string
for the download directory. The constructor will download the dataset
to the download directory. The dataset is downloaded in the version
used by Datasets Cloud, which may be different from the version
used by the dataset’s original developers.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>dataset_name (str):</dt><dd><p>The name of the dataset.</p>
</dd>
<dt>download_dir (str):</dt><dd><p>The directory where the dataset will be downloaded.</p>
</dd>
<dt>use_public_access (bool):</dt><dd><p>Whether to use public access. If you want
to use the Google Cloud Storage API, you must set this to True.
Please make sure you have the appropriate credentials.</p>
</dd>
<dt>path_to_credentials (str):</dt><dd><p>Path to the credentials file.
Only used if public_access is False and credentials are not
provided. Defaults to None.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>torch.utils.data.DataLoader: The dataloader for the dataset.</p>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>ValueError:</dt><dd><p>If the dataset_name is not a valid dataset that exists
in Datasets Cloud.</p>
</dd>
<dt>ValueError:</dt><dd><p>If the download_directory is not a valid directory.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.DlBuilderFromDataCloud.build_dataloaders">
<span class="sig-name descname"><span class="pre">build_dataloaders</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.utils.data.dataloader.DataLoader</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.utils.data.dataloader.DataLoader</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.utils.data.dataloader.DataLoader</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.DlBuilderFromDataCloud.build_dataloaders" title="Permalink to this definition"></a></dt>
<dd><p>Builds the dataloaders for the dataset.</p>
<dl class="simple">
<dt>Args:</dt><dd><p><a href="#id1"><span class="problematic" id="id2">**</span></a>kwargs: Arguments for the dataloader builder.</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>Tuple[DataLoader, DataLoader, DataLoader]:</dt><dd><p>The dataloaders for the dataset (train, validation, test).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.DlBuilderFromDataCloud.get_metadata">
<span class="sig-name descname"><span class="pre">get_metadata</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.DlBuilderFromDataCloud.get_metadata" title="Permalink to this definition"></a></dt>
<dd><p>Returns the metadata of the dataset.</p>
<dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>Dict[str, Any]:</dt><dd><p>The metadata of the dataset.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.GenericDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">GenericDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.GenericDataset" title="Permalink to this definition"></a></dt>
<dd><p>This class is the base class for the tori-datasets</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>data (Tensor):</dt><dd><p>tensor with first dimension
the number of samples</p>
</dd>
<dt>taregts (list):</dt><dd><p>list of labels</p>
</dd>
<dt>transform (Callable):</dt><dd><p>act on the single images</p>
</dd>
<dt>target_transform (Callable):</dt><dd><p>act on the single label</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.OrbitsGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">OrbitsGenerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(2.5,</span> <span class="pre">3.5,</span> <span class="pre">4.0,</span> <span class="pre">4.1,</span> <span class="pre">4.3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_orbits_per_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_pts_per_orbit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">homology_dimensions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_percentage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_percentage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamical_system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'classical_convention'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'float32'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arbitrary_precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.OrbitsGenerator" title="Permalink to this definition"></a></dt>
<dd><p>Generate Orbit dataset consistent of orbits defined by the dynamical system
x[n+1] = x[n] + r * y[n] * (1  - y[n]) % 1
y[n+1] = y[n] + r * x[n+1] * (1 - x[n+1]) % 1
Note that there is an x[n+1] value in the second dimension.
The parameter r is an hyperparameter and the classification task is to predict
it given the orbit.
By default r is chosen from (2.5, 3.5, 4.0, 4.1, 4.3).
Args:</p>
<blockquote>
<div><dl class="simple">
<dt>parameters (Tuple[float]): </dt><dd><p>Hyperparameter of the dynamical systems.</p>
</dd>
<dt>num_orbits_per_class (int): </dt><dd><p>number of orbits per class.</p>
</dd>
<dt>num_pts_per_orbit (int): </dt><dd><p>number of points per orbit.</p>
</dd>
<dt>homology_dimensions (Sequence[int]): </dt><dd><p>homology dimension of the persistence
diagrams.</p>
</dd>
<dt>validation_percentage (float, optional): </dt><dd><p>Percentage of the validation dataset.
Defaults to 0.0.</p>
</dd>
<dt>test_percentage (float, optional): </dt><dd><p>Percentage of the test dataset. Defaults to 0.0.</p>
</dd>
<dt>dynamical_system (str, optional): </dt><dd><p>either use persistence paths
convention ´pp_convention´ or the classical convention
´classical_convention´. Defaults to ‘´classical_convention´’.</p>
</dd>
<dt>n_jobs (int, optional): </dt><dd><p>number of cpus to run the computation on. Defaults to 1.</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.OrbitsGenerator.get_dataloader_combined">
<span class="sig-name descname"><span class="pre">get_dataloader_combined</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloaders_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gdeep.data.DataLoaderKwargs" title="gdeep.data.parallel_orbit.DataLoaderKwargs"><span class="pre">gdeep.data.parallel_orbit.DataLoaderKwargs</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.utils.data.dataloader.DataLoader</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.utils.data.dataloader.DataLoader</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.utils.data.dataloader.DataLoader</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.OrbitsGenerator.get_dataloader_combined" title="Permalink to this definition"></a></dt>
<dd><p>Generates a Dataloader from the orbits dataset and the persistence diagrams
Returns:</p>
<blockquote>
<div><dl class="simple">
<dt>DataLoader: </dt><dd><p>Dataloader of orbits and persistence diagrams</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.OrbitsGenerator.get_dataloader_orbits">
<span class="sig-name descname"><span class="pre">get_dataloader_orbits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloaders_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gdeep.data.DataLoaderKwargs" title="gdeep.data.parallel_orbit.DataLoaderKwargs"><span class="pre">gdeep.data.parallel_orbit.DataLoaderKwargs</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.utils.data.dataloader.DataLoader</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.utils.data.dataloader.DataLoader</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.utils.data.dataloader.DataLoader</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.OrbitsGenerator.get_dataloader_orbits" title="Permalink to this definition"></a></dt>
<dd><p>Generates a Dataloader from the orbits dataset 
Returns:</p>
<blockquote>
<div><dl class="simple">
<dt>DataLoader: </dt><dd><p>Dataloader of orbits</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.OrbitsGenerator.get_dataloader_persistence_diagrams">
<span class="sig-name descname"><span class="pre">get_dataloader_persistence_diagrams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloaders_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gdeep.data.DataLoaderKwargs" title="gdeep.data.parallel_orbit.DataLoaderKwargs"><span class="pre">gdeep.data.parallel_orbit.DataLoaderKwargs</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.utils.data.dataloader.DataLoader</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.utils.data.dataloader.DataLoader</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.utils.data.dataloader.DataLoader</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.OrbitsGenerator.get_dataloader_persistence_diagrams" title="Permalink to this definition"></a></dt>
<dd><p>Generates a Dataloader from the persistence diagrams dataset 
Returns:</p>
<blockquote>
<div><dl class="simple">
<dt>Tuple[DataLoader, DataLoader, DataLoader]:</dt><dd><p>Dataloaders of persistence diagrams</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.OrbitsGenerator.get_orbits">
<span class="sig-name descname"><span class="pre">get_orbits</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.OrbitsGenerator.get_orbits" title="Permalink to this definition"></a></dt>
<dd><p>Returns the orbits as an ndarrays of shape
(num_classes * num_orbits_per_class, num_pts_per_orbit, 2)
Returns:</p>
<blockquote>
<div><dl class="simple">
<dt>np.ndarray: </dt><dd><p>Orbits</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.OrbitsGenerator.get_persistence_diagrams">
<span class="sig-name descname"><span class="pre">get_persistence_diagrams</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.OrbitsGenerator.get_persistence_diagrams" title="Permalink to this definition"></a></dt>
<dd><p>Returns the orbits as an ndarrays of shape
(num_classes * num_orbits_per_class, num_topological_features, 3)
Returns:</p>
<blockquote>
<div><dl class="simple">
<dt>np.ndarray: </dt><dd><p>Persistence diagrams</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.PreprocessTextData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">PreprocessTextData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocabulary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.PreprocessTextData" title="Permalink to this definition"></a></dt>
<dd><p>Preprocessing class. This class is useful to convert the data format
<code class="docutils literal notranslate"><span class="pre">(label,</span> <span class="pre">text)</span></code> into the proper tensor format <code class="docutils literal notranslate"><span class="pre">(</span> <span class="pre">word_embedding,</span> <span class="pre">label)</span></code></p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>tokenizer (torch Tokenizer):</dt><dd><p>the tokenizer of the source text</p>
</dd>
<dt>vocabulary (torch Vocabulary):</dt><dd><p>the vocubulary; it can be built of it can be
given.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.PreprocessTextData.fit_to_data">
<span class="sig-name descname"><span class="pre">fit_to_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.PreprocessTextData.fit_to_data" title="Permalink to this definition"></a></dt>
<dd><p>Method to extract global data, like to length of
the sentences to be able to pad.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>data (iterable):</dt><dd><p>the data in the format <code class="docutils literal notranslate"><span class="pre">(label,</span> <span class="pre">text)</span></code></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.PreprocessTextData.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#gdeep.data.PreprocessTextData.transform" title="Permalink to this definition"></a></dt>
<dd><p>This method is applied to each batch and
transforms it following the rule below</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>datum (tuple):</dt><dd><p>a single datum, being it a tuple
with <code class="docutils literal notranslate"><span class="pre">(label,</span> <span class="pre">text)</span></code></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.PreprocessTextLabel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">PreprocessTextLabel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.PreprocessTextLabel" title="Permalink to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.PreprocessTextLabel.fit_to_data">
<span class="sig-name descname"><span class="pre">fit_to_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.PreprocessTextLabel.fit_to_data" title="Permalink to this definition"></a></dt>
<dd><p>This method deals with getting dataset-level information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.PreprocessTextLabel.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#gdeep.data.PreprocessTextLabel.transform" title="Permalink to this definition"></a></dt>
<dd><p>This method deals with datum-wise transformations. This
method is called in the Datasets to transform the output
of <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.PreprocessTextQA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">PreprocessTextQA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vocabulary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.PreprocessTextQA" title="Permalink to this definition"></a></dt>
<dd><p>Class to preprocess text dataloaders for Q&amp;A
tasks</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>vocabulary (torch Vocab):</dt><dd><p>the torch vocabulary</p>
</dd>
<dt>tokenizer (torch Tokenizer):</dt><dd><p>the tokenizer of the source text</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gdeep.data</span> <span class="kn">import</span> <span class="n">TorchDataLoader</span>
<span class="kn">from</span> <span class="nn">gdeep.data</span> <span class="kn">import</span>  <span class="n">TextDatasetQA</span><span class="p">,</span> <span class="n">PreprocessTextQA</span><span class="p">,</span> <span class="n">PreprocessTextQATarget</span>

<span class="n">dl</span> <span class="o">=</span> <span class="n">TorchDataLoader</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;SQuAD2&quot;</span><span class="p">,</span> <span class="n">convert_to_map_dataset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dl_tr</span><span class="p">,</span> <span class="n">dl_ts</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">build_dataloaders</span><span class="p">()</span>

<span class="n">textds</span> <span class="o">=</span> <span class="n">TextDatasetQA</span><span class="p">(</span><span class="n">dl_tr_str</span><span class="o">.</span><span class="n">dataset</span><span class="p">,</span>
                       <span class="n">PreprocessTextQA</span><span class="p">(),</span>
                       <span class="n">PreprocessTextQATarget</span><span class="p">())</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.PreprocessTextQA.fit_to_data">
<span class="sig-name descname"><span class="pre">fit_to_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.PreprocessTextQA.fit_to_data" title="Permalink to this definition"></a></dt>
<dd><p>This method deals with getting dataset-level information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.PreprocessTextQA.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.PreprocessTextQA.transform" title="Permalink to this definition"></a></dt>
<dd><p>This method deals with datum-wise transformations. This
method is called in the Datasets to transform the output
of <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.PreprocessTextQATarget">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">PreprocessTextQATarget</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.PreprocessTextQATarget" title="Permalink to this definition"></a></dt>
<dd><p>Class to preprocess text dataloaders for Q&amp;A
tasks</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>tokenizer (torch Tokenizer):</dt><dd><p>the tokenizer of the source text</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.PreprocessTextQATarget.fit_to_data">
<span class="sig-name descname"><span class="pre">fit_to_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.PreprocessTextQATarget.fit_to_data" title="Permalink to this definition"></a></dt>
<dd><p>This method deals with getting dataset-level information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.PreprocessTextQATarget.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datum</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.PreprocessTextQATarget.transform" title="Permalink to this definition"></a></dt>
<dd><p>This method deals with datum-wise transformations. This
method is called in the Datasets to transform the output
of <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.PreprocessTextTranslation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">PreprocessTextTranslation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vocabulary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocabulary_target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer_target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.PreprocessTextTranslation" title="Permalink to this definition"></a></dt>
<dd><p>Class to preprocess text dataloaders for translation
tasks</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>vocabulary (torch Vocabulary):</dt><dd><p>the vocubulary of the source text;
it can be built automatically or it can be
given.</p>
</dd>
<dt>vocabulary_target (torch Vocabulary):</dt><dd><p>the vocubulary of the target text;
it can be built automatically or it can be
given.</p>
</dd>
<dt>tokenizer (torch Tokenizer):</dt><dd><p>the tokenizer of the source text</p>
</dd>
<dt>tokenizer_target (torch Tokenizer):</dt><dd><p>the tokenizer of the target text</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gdeep.data</span> <span class="kn">import</span> <span class="n">TorchDataLoader</span>
<span class="kn">from</span> <span class="nn">gdeep.data</span> <span class="kn">import</span> <span class="n">TextDatasetTranslation</span><span class="p">,</span> <span class="n">PreprocessTextTranslation</span>

<span class="n">dl</span> <span class="o">=</span> <span class="n">TorchDataLoader</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Multi30k&quot;</span><span class="p">,</span> <span class="n">convert_to_map_dataset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dl_tr</span><span class="p">,</span> <span class="n">dl_ts</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">build_dataloaders</span><span class="p">()</span>

<span class="n">textds</span> <span class="o">=</span> <span class="n">TextDatasetTranslation</span><span class="p">(</span><span class="n">dl_tr</span><span class="o">.</span><span class="n">dataset</span><span class="p">,</span>
    <span class="n">PreprocessTextTranslation</span><span class="p">(),</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.PreprocessTextTranslation.fit_to_data">
<span class="sig-name descname"><span class="pre">fit_to_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.PreprocessTextTranslation.fit_to_data" title="Permalink to this definition"></a></dt>
<dd><p>This method deals with getting dataset-level information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.PreprocessTextTranslation.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datum</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.PreprocessTextTranslation.transform" title="Permalink to this definition"></a></dt>
<dd><p>This method is applied to each batch and
transforms it following the rule below</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>datum (torch.tensor):</dt><dd><p>a single datum</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.PreprocessingPipeline">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">PreprocessingPipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_of_preproc_and_datatypes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.PreprocessingPipeline" title="Permalink to this definition"></a></dt>
<dd><p>class to compose preprocessing classes. The
order is very important, and to make sure that the output of
one preprocessing is acceptable as input for the
following preprocessing</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>list_of_preproc_and_datatypes (list):</dt><dd><p>list of tuples in which the the first
element if the class instance of the
AbstractPreprocessing and the second element
is the Dataset class (not the instance!)</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gdeep.data</span> <span class="kn">import</span> <span class="n">PreprocessingPipeline</span><span class="p">,</span> <span class="n">Normalisation</span>
<span class="kn">from</span> <span class="nn">gdeep.data</span> <span class="kn">import</span> <span class="n">PreprocessTextData</span><span class="p">,</span> <span class="n">TextDataset</span>

<span class="n">PreprocessingPipeline</span><span class="p">(((</span><span class="n">PreprocessTextData</span><span class="p">(),</span> <span class="n">TextDataset</span><span class="p">),</span>
                       <span class="p">(</span><span class="n">Normalisation</span><span class="p">(),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">__</span><span class="p">:</span><span class="n">x</span><span class="p">)))</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.PreprocessingPipeline.fit_to_data">
<span class="sig-name descname"><span class="pre">fit_to_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.PreprocessingPipeline.fit_to_data" title="Permalink to this definition"></a></dt>
<dd><p>This method deals with getting dataset-level information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.PreprocessingPipeline.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#gdeep.data.PreprocessingPipeline.transform" title="Permalink to this definition"></a></dt>
<dd><p>This method deals with datum-wise transformations. This
method is called in the Datasets to transform the output
of <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.Rotation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">Rotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.Rotation" title="Permalink to this definition"></a></dt>
<dd><p>Class for rotations</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.TextDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">TextDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.utils.data.dataset.Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#gdeep.data.AbstractPreprocessing" title="gdeep.data.preprocessing_interface.AbstractPreprocessing"><span class="pre">gdeep.data.preprocessing_interface.AbstractPreprocessing</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#gdeep.data.AbstractPreprocessing" title="gdeep.data.preprocessing_interface.AbstractPreprocessing"><span class="pre">gdeep.data.preprocessing_interface.AbstractPreprocessing</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.TextDataset" title="Permalink to this definition"></a></dt>
<dd><p>This class is the base class for the text-datasets.
The source dataset for this class are expected to be
dataset of the form <code class="docutils literal notranslate"><span class="pre">(label,</span> <span class="pre">string)</span></code>.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>dataset (torch Dataset):</dt><dd><p>The source dataset for this class.
It is expected to be a
dataset of the form <code class="docutils literal notranslate"><span class="pre">(label,</span> <span class="pre">string)</span></code>.</p>
</dd>
<dt>transform (AbstractPreprocessing):</dt><dd><p>the instance of the class of preprocessing.
It inherits from <code class="docutils literal notranslate"><span class="pre">AbstractPreprocessing</span></code></p>
</dd>
<dt>target_transform (AbstractPreprocessing):</dt><dd><p>the instance of the class of preprocessing.
It inherits from <code class="docutils literal notranslate"><span class="pre">AbstractPreprocessing</span></code></p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gdeep.data</span> <span class="kn">import</span> <span class="n">TorchDataLoader</span>
<span class="kn">from</span> <span class="nn">gdeep.data</span> <span class="kn">import</span> <span class="n">TextDataset</span><span class="p">,</span> <span class="n">PreprocessTextData</span><span class="p">,</span> <span class="n">PreprocessTextLabel</span>

<span class="n">dl</span> <span class="o">=</span> <span class="n">TorchDataLoader</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;AG_NEWS&quot;</span><span class="p">,</span> <span class="n">convert_to_map_dataset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dl_tr</span><span class="p">,</span> <span class="n">dl_ts</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">build_dataloaders</span><span class="p">()</span>

<span class="n">textds</span> <span class="o">=</span> <span class="n">TextDataset</span><span class="p">(</span><span class="n">dl_tr</span><span class="o">.</span><span class="n">dataset</span><span class="p">,</span>
                     <span class="n">PreprocessTextData</span><span class="p">(),</span>
                     <span class="n">PreprocessTextLabel</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.TextDatasetQA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">TextDatasetQA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.utils.data.dataset.Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#gdeep.data.AbstractPreprocessing" title="gdeep.data.preprocessing_interface.AbstractPreprocessing"><span class="pre">gdeep.data.preprocessing_interface.AbstractPreprocessing</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#gdeep.data.AbstractPreprocessing" title="gdeep.data.preprocessing_interface.AbstractPreprocessing"><span class="pre">gdeep.data.preprocessing_interface.AbstractPreprocessing</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.TextDatasetQA" title="Permalink to this definition"></a></dt>
<dd><p>This class is the class for the text datasets
dealing with Q&amp;A tasks. The source data is expected
to be of the form <code class="docutils literal notranslate"><span class="pre">(string,</span> <span class="pre">string,</span> <span class="pre">list[string],</span> <span class="pre">list[int])</span></code> containing the
senteces <code class="docutils literal notranslate"><span class="pre">(context,</span> <span class="pre">question,</span> <span class="pre">[answer(s)],</span>
<span class="pre">[initial</span> <span class="pre">position</span> <span class="pre">(in</span> <span class="pre">characters)</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">answer(s)]))</span></code>.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>dataset (torch Dataset):</dt><dd><p>The source dataset for this class.
It is expected to be a
dataset of the form <code class="docutils literal notranslate"><span class="pre">(label,</span> <span class="pre">string)</span></code>.</p>
</dd>
<dt>transform (AbstractPreprocessing):</dt><dd><p>the instance of the class of preprocessing.
It inherits from <code class="docutils literal notranslate"><span class="pre">AbstractPreprocessing</span></code></p>
</dd>
<dt>target_transform (AbstractPreprocessing):</dt><dd><p>the instance of the class of preprocessing.
It inherits from <code class="docutils literal notranslate"><span class="pre">AbstractPreprocessing</span></code></p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tensor, tensor:</dt><dd><p>the first tensor has three dimensions, <code class="docutils literal notranslate"><span class="pre">(BS,</span> <span class="pre">2,</span> <span class="pre">MAX_LENGTH)</span></code>;
this tensor represents the stacking of both the tokenisation
of the context and question sentence.
The second tensor is just the batch of pairs of start and
end positions of the answers</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gdeep.data</span> <span class="kn">import</span> <span class="n">TorchDataLoader</span>
<span class="kn">from</span> <span class="nn">gdeep.data</span> <span class="kn">import</span>  <span class="n">TextDatasetQA</span><span class="p">,</span> <span class="n">PreprocessTextQA</span><span class="p">,</span> <span class="n">PreprocessTextQATarget</span>

<span class="n">dl</span> <span class="o">=</span> <span class="n">TorchDataLoader</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;SQuAD2&quot;</span><span class="p">,</span> <span class="n">convert_to_map_dataset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dl_tr</span><span class="p">,</span> <span class="n">dl_ts</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">build_dataloaders</span><span class="p">()</span>

<span class="n">textds</span> <span class="o">=</span> <span class="n">TextDatasetQA</span><span class="p">(</span><span class="n">dl_tr_str</span><span class="o">.</span><span class="n">dataset</span><span class="p">,</span>
                       <span class="n">PreprocessTextQA</span><span class="p">(),</span>
                       <span class="n">PreprocessTextQATarget</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.TextDatasetTranslation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">TextDatasetTranslation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.utils.data.dataset.Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#gdeep.data.AbstractPreprocessing" title="gdeep.data.preprocessing_interface.AbstractPreprocessing"><span class="pre">gdeep.data.preprocessing_interface.AbstractPreprocessing</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#gdeep.data.AbstractPreprocessing" title="gdeep.data.preprocessing_interface.AbstractPreprocessing"><span class="pre">gdeep.data.preprocessing_interface.AbstractPreprocessing</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.TextDatasetTranslation" title="Permalink to this definition"></a></dt>
<dd><p>This class is the class for the text datasets
dealing with translation tasks. The source data is expected
to be of the form <code class="docutils literal notranslate"><span class="pre">(string,</span> <span class="pre">string)</span></code> containing the
senteces to translate (left string translates into right string).</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>dataset (torch Dataset):</dt><dd><p>The source dataset for this class.
It is expected to be a
dataset of the form <code class="docutils literal notranslate"><span class="pre">(label,</span> <span class="pre">string)</span></code>.</p>
</dd>
<dt>transform (AbstractPreprocessing):</dt><dd><p>the instance of the class of preprocessing.
It inherits from <code class="docutils literal notranslate"><span class="pre">AbstractPreprocessing</span></code></p>
</dd>
<dt>target_transform (AbstractPreprocessing):</dt><dd><p>the instance of the class of preprocessing.
It inherits from <code class="docutils literal notranslate"><span class="pre">AbstractPreprocessing</span></code></p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tensor, tensor:</dt><dd><p>the first tensor has three dimensions, <code class="docutils literal notranslate"><span class="pre">(BS,</span> <span class="pre">2,</span> <span class="pre">MAX_LENGTH)</span></code>;
this tensor represents the stacking of both the tokenisation
of the source and target sentence.</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gdeep.data</span> <span class="kn">import</span> <span class="n">TorchDataLoader</span>
<span class="kn">from</span> <span class="nn">gdeep.data</span> <span class="kn">import</span> <span class="n">TextDatasetTranslation</span><span class="p">,</span> <span class="n">PreprocessTextTranslation</span>

<span class="n">dl</span> <span class="o">=</span> <span class="n">TorchDataLoader</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Multi30k&quot;</span><span class="p">,</span> <span class="n">convert_to_map_dataset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dl_tr</span><span class="p">,</span> <span class="n">dl_ts</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">build_dataloaders</span><span class="p">()</span>

<span class="n">textds</span> <span class="o">=</span> <span class="n">TextDatasetTranslation</span><span class="p">(</span><span class="n">dl_tr</span><span class="o">.</span><span class="n">dataset</span><span class="p">,</span>
    <span class="n">PreprocessTextTranslation</span><span class="p">(),</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.TorchDataLoader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">TorchDataLoader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'MNIST'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convert_to_map_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.TorchDataLoader" title="Permalink to this definition"></a></dt>
<dd><p>Class to obtain DataLoaders from the classical
datasets available on pytorch.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>name (string):</dt><dd><p>check the available datasets at
<a class="reference external" href="https://pytorch.org/vision/stable/datasets.html">https://pytorch.org/vision/stable/datasets.html</a></p>
</dd>
<dt>convert_to_map_dataset (bool):</dt><dd><p>whether to convert an IterableDataset to a
MapDataset</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.TorchDataLoader.build_dataloaders">
<span class="sig-name descname"><span class="pre">build_dataloaders</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="headerlink" href="#gdeep.data.TorchDataLoader.build_dataloaders" title="Permalink to this definition"></a></dt>
<dd><p>This method is to be called once the class
has been initialised with the dataset name</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>kwargs (dict):</dt><dd><p>The keyword arguments for the torch.DataLoader</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple:</dt><dd><p>The first element is the train DataLoader
while the second the test DataLoader</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gdeep.data.create_pd_orbits">
<span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">create_pd_orbits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">homology_dimensions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="headerlink" href="#gdeep.data.create_pd_orbits" title="Permalink to this definition"></a></dt>
<dd><p>Computes the weak alpha persistence of the orbit data clouds.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>orbits (np.array): </dt><dd><p>Orbits of shape [n_points, 2]</p>
</dd>
<dt>homology_dimensions (tuple, optional): </dt><dd><p>Dimensions to compute the
persistence diagrams.
Defaults to (0, 1).</p>
</dd>
<dt>n_jobs (int, optional): </dt><dd><p>Number of cpus to use for parallel computation.
Defaults to multiprocessing.cpu_count().</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>np.array: </dt><dd><p>Array of persistence diagrams of shape
[num_classes, num_orbits, num_persistence_points, 3].
In the last dimension the first two values are the coordinates of
the points in the persistence diagrams and the third is the
homology dimension.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gdeep.data.generate_orbit_parallel">
<span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">generate_orbit_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_orbits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_pts_per_orbit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[1.0]</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="headerlink" href="#gdeep.data.generate_orbit_parallel" title="Permalink to this definition"></a></dt>
<dd><p>Generate sequence of points of a dynamical system
in a parallel manner.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>num_classes (int): </dt><dd><p>number of classes of dynamical systems.</p>
</dd>
<dt>num_orbits (int): </dt><dd><p>number of orbits of dynamical system per class.</p>
</dd>
<dt>num_pts_per_orbit (int, optional): </dt><dd><p>Number of points to generate.
Defaults to 100.</p>
</dd>
<dt>parameter (List[float], optional): </dt><dd><p>List of parameters of the dynamical
system.
Defaults to [1.0].</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>np.ndarray: </dt><dd><p>Array of sampled points of the dynamical system.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="bert.html" class="btn btn-neutral float-left" title="BERT" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="models.html" class="btn btn-neutral float-right" title="Models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, L2F SA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>