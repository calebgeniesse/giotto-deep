# %%
import numpy as np  # type: ignore
import time


def generate_orbit(num_pts_per_orbit: int = 100,
                   parameter: float = 1.0) -> np.ndarray:
    """Generate sequence of points of a dynamical system

    Args:
        num_pts_per_orbit (int, optional): Number of points to generate.
            Defaults to 100.
        parameter (float, optional): Parameter of the dynamical system.
            Defaults to 1.0.

    Returns:
        np.ndarray: Array of sampled points of the dynamical system.
    """
    try:
        assert parameter > 0
    except AssertionError:
        print('Parameter must be greater than 0')
    try:
        assert num_pts_per_orbit > 0
    except AssertionError:
        print('num_pts_per_orbit must be greater than 0')

    orbit = np.zeros([num_pts_per_orbit, 2])
    x_cur, y_cur = np.random.rand(), np.random.rand()  # current points
    for idx in range(0, num_pts_per_orbit):
        orbit[idx, 0] = x_cur
        orbit[idx, 1] = y_cur
        x_cur = (x_cur + parameter * y_cur * (1. - y_cur)) % 1
        y_cur = (y_cur + parameter * x_cur * (1. - x_cur)) % 1
    return orbit

# %%


parameters = (2.5, 3.5, 4.0, 4.1, 4.3)  # different classes of orbits
homology_dimensions = (0, 1)

config = {
    'parameters': parameters,
    'num_classes': len(parameters),
    'num_orbits': 5000,
    'num_pts_per_orbit': 1000,
    'homology_dimensions': homology_dimensions,
    'num_homology_dimensions': len(homology_dimensions)
}

time_start = time.perf_counter()

x_previous = np.zeros((
                config['num_classes'],  # type: ignore
                config['num_orbits'],
                config['num_pts_per_orbit'],
                2
            ))

# generate dataset
for cidx, p in enumerate(config['parameters']):  # type: ignore
    for i in range(config['num_orbits']):  # type: ignore
        x_previous[cidx][i] = generate_orbit(
            num_pts_per_orbit=config['num_pts_per_orbit'],  # type: ignore
            parameter=p
            )
time_elapsed = (time.perf_counter() - time_start)
print('time elapsed', time_elapsed)

time_start = time.perf_counter()
x = np.zeros((  # type: ignore
    config['num_classes'],
    config['num_orbits'],
    config['num_pts_per_orbit'],
    2
    ))

for cidx, p in enumerate(config['parameters']):  # type: ignore
    x[cidx, :, 0, :] = x_previous[cidx, :, 0, :]

    for i in range(1, config['num_pts_per_orbit']):  # type: ignore
        x_cur = x[cidx, :, i - 1, 0]
        y_cur = x[cidx, :, i - 1, 1]

        x[cidx, :, i, 0] = (x_cur + p * y_cur * (1. - y_cur)) % 1
        x_next = x[cidx, :, i, 0]
        x[cidx, :, i, 1] = (y_cur + p * x_next * (1. - x_next)) % 1

time_elapsed = (time.perf_counter() - time_start)
print('time elapsed', time_elapsed)


assert np.allclose(x_previous, x)
# %%
l = [23.23211158066988,  22.915904566645622,  23.60259478352964,  23.04874351620674,  21.900603853166103,  22.432633452117443,  22.787495754659176,  24.92519810795784,  22.920031383633614,  23.14513449370861,  22.081069827079773,  22.239149153232574,  23.49371963739395,  22.27109895646572,  23.570071533322334,  23.1067386418581,  21.96251641958952,  21.85334974527359,  23.139514192938805,  22.550762474536896,  22.03124088048935,  22.161614321172237,  21.85580999404192,  21.758806623518467,  21.647666417062283,  21.022108897566795,  21.57971277087927,  21.394039154052734,  21.69527082145214,  21.98325538635254,  23.25206981599331,  23.08256071805954,  21.62453158199787,  21.50847554206848,  21.92027986049652,  21.1614683046937,  21.348843060433865,  21.194975532591343,  21.83024324476719,  21.249726969748735,  20.675750717520714,  21.218392074108124,  20.664209969341755,  21.0766758620739,  21.26332012563944,  21.1227575391531,  22.77891781926155,  22.84906756132841,  60.95499221980572,  35.59184110164642,  28.524176239967346,  23.674996338784695,  25.276585966348648,  22.675848841667175,  22.61154969036579,  22.250553339719772,  22.566216595470905,  22.026917666196823,  22.557393673807383,  21.618418283760548,  22.290103569626808,  22.39701808989048,  22.690431341528893,  22.22721755504608,  22.137743532657623,  21.823957711458206,  21.056820765137672,  20.778126627206802,  21.1414842158556,  22.61694687604904,  22.051336959004402,  21.022346034646034,  21.348338779062033,  20.845118701457977,  20.476106598973274,  21.35976229608059,  21.62142914533615,  21.20849595963955,  20.869649790227413,  20.70587456226349,  21.246968530118465,  21.42128697037697,  21.471062809228897,  20.404365994036198,  21.49219086021185,  21.095777802169323,  21.779516212642193,  21.889298982918262,  21.311727076768875,  21.62272161990404,  22.540631532669067,  21.76011859625578,  20.929521657526493,  20.391536101698875,  21.17210140824318,  21.4020683914423,  28.63746728003025,  21.353158928453922,  20.90583862364292,  20.77300687134266,  21.225853994488716,  20.896934539079666,  20.534169428050518,  20.800402089953423,  21.098456516861916,  20.2485691010952,  20.267427176237106,  20.430618427693844,  20.788892582058907,  20.599410958588123,  19.7302518337965,  21.00359596312046,  20.159523256123066,  20.2813178896904,  21.987240001559258,  21.89704228937626,  21.26491790264845,  20.4350546002388,  20.881342090666294,  20.41232070326805,  19.894668638706207,  20.645278923213482,  20.929392494261265,  20.976625069975853,  19.966413728892803,  20.2869950607419,  20.75695711374283,  21.05167029798031,  20.682739324867725,  20.3928132802248,  20.154005214571953,  20.433666720986366,  24.46332038938999,  22.47602015733719,  21.250598944723606,  20.485619604587555,  20.654226779937744,  19.702191419899464,  19.683677792549133,  20.92492112517357,  19.378768287599087,  19.892482742667198,  19.680758706294,  19.448336355388165,  20.887616001069546,  21.44575272500515,  20.72765503078699,  20.131760716438293,  20.71079533547163,  20.171717101708055,  20.803773805499077,  19.762252029031515,  20.00907239317894,  21.20061752386391,  20.664450109004974,  21.66252426803112,  20.737278260290623,  20.4454530403018,  20.303930200636387,  20.411162972450256,  20.072168059647083,  19.584297120571136,  19.987316213548183,  19.848204411566257,  20.337177574634552,  20.839743174612522,  20.796141050755978,  21.044670946896076,  20.60816004127264,  19.51188673079014,  19.381571911275387,  20.138065353035927,  21.026920720934868,  20.44385313987732,  20.238343119621277,  20.94810065627098,  21.932914681732655,  21.018298000097275,  20.761089086532593,  19.702142515219748,  19.31914479844272,  19.61485669761896,  20.34793694317341,  19.42465840280056,  21.653041027486324,  21.089027799665928,  22.67371379584074,  21.26384510844946,  20.346055939793587,  19.229798689484596,  20.285119123756886,  18.780079578980803,  19.600432731211185,  20.285379074513912,  26.615318009629846,  21.360230868682265,  20.221531629562378,  20.480050303041935,  20.02685385942459,  20.528645917773247]
# %%
l2 = [20.747889026999474,
 20.65145505219698,
 20.403223231434822,
 22.15877155959606,
 19.879891455173492,
 19.693836897611618,
 19.675016447901726,
 19.363330580294132,
 19.44016182422638,
 18.9577427059412,
 19.897639617323875,
 20.536432534456253,
 19.505483224987984,
 19.21921593695879,
 20.123308464884758,
 19.498684279620647,
 19.730875335633755,
 19.30934865772724,
 18.915795024484396,
 20.589476868510246,
 20.251872450113297,
 19.54478994011879,
 21.2074057161808,
 19.810751482844353,
 19.04927945137024,
 19.38615544140339,
 19.275047704577446,
 19.48431959748268,
 19.619800619781017,
 19.519689172506332,
 19.426263887435198,
 20.351188600063324,
 19.604546420276165,
 20.618958920240402,
 22.48147886991501,
 25.309450939297676,
 20.21900037676096,
 19.108687222003937,
 19.23652637563646,
 19.176945492625237,
 19.64499705284834,
 18.67485513538122,
 18.681979089975357,
 19.130590957589447,
 19.176518999040127,
 19.152336910367012,
 19.355161927640438,
 18.850413415580988,
 18.658433236181736,
 19.136043176054955,
 19.72250735014677,
 19.370171554386616,
 19.215360939502716,
 20.086062289774418,
 18.772899366915226,
 19.01672700792551,
 19.984723672270775,
 19.432552695274353,
 19.809822127223015,
 19.935061760246754,
 20.449982427060604,
 19.347118861973286,
 19.031611278653145,
 20.24380374699831,
 19.81159383058548,
 19.64027851819992,
 19.28117172420025,
 19.473004579544067,
 19.355512894690037,
 19.629364907741547,
 22.53117224574089,
 19.71199019998312,
 20.10910116136074,
 19.95346738025546,
 19.188880562782288,
 23.70314695313573,
 19.379848286509514,
 19.02339281141758,
 18.981436416506767,
 19.77435465157032,
 19.450620852410793,
 19.458521619439125,
 18.646914415061474,
 18.047999314963818,
 19.202477544546127,
 19.152652107179165,
 18.862824857234955,
 20.531135834753513,
 20.01679115742445,
 19.53817232325673,
 18.982172705233097,
 19.522930532693863,
 19.05940624512732,
 19.14199759066105,
 20.07527581602335,
 19.5769202709198,
 18.43622412532568,
 18.407309643924236,
 18.886694237589836,
 23.336259230971336,
 75.15317237377167,
 30.441627621650696,
 22.64421896636486,
 21.74629235267639,
 20.438878536224365,
 21.395177632570267,
 20.52278524171561,
 20.38651465624571,
 19.888123102486134,
 19.95175191015005,
 20.074973806738853,
 20.042950816452503,
 20.32078316807747,
 19.858730606734753,
 19.65034320577979,
 19.56825517117977,
 19.16908736526966,
 19.065432101488113,
 20.17322351783514,
 19.768902353942394,
 19.41501072049141,
 19.52943103760481,
 19.087099440395832,
 18.947231575846672,
 18.91526820510626,
 22.232127279043198,
 20.846785366535187,
 19.55872804671526,
 19.295034363865852,
 20.030160948634148,
 19.889808237552643,
 19.032955832779408,
 18.652519047260284,
 18.65481685101986,
 19.379982627928257,
 18.92787417769432,
 18.980670139193535,
 19.06461938470602,
 18.292036797851324,
 18.51029296964407,
 18.87052471935749,
 18.801198296248913,
 18.300055995583534,
 19.298768222332,
 19.15946315228939,
 18.553878232836723,
 19.482360631227493,
 19.717759385704994,
 18.381419360637665,
 19.46101277321577,
 18.644518613815308,
 18.151390550658107,
 18.61205697618425,
 18.92248486727476,
 18.108482838608325,
 18.499680453911424,
 19.071105778217316,
 19.411020025610924,
 19.176791951060295,
 18.79061149759218,
 19.054873637855053,
 19.57502706348896,
 19.130050502717495,
 19.410554721951485,
 20.077072247862816,
 19.525215730071068,
 19.625617001671344,
 20.214459367096424,
 18.992615941911936,
 18.73714130371809,
 18.579123876988888,
 18.25071892887354,
 18.298283524811268,
 18.06216725707054,
 18.775686532258987,
 19.327721789479256,
 19.52349530160427,
 19.022172041237354,
 19.088169530034065,
 18.97410038113594,
 19.099428728222847,
 18.497783295810223,
 18.807782545685768,
 19.527277022600174,
 19.33628150820732,
 19.177831441164017,
 18.51257561892271,
 18.45180903468281,
 18.194550059735775,
 19.049149490892887,
 19.516482021659613,
 19.907648339867592,
 18.591876413673162,
 19.77905486524105,
 19.427528388798237,
 18.498423665761948,
 18.459959499537945,
 20.76567144691944,
 18.899810649454594,
 18.39121450483799,
 19.154430359601974,
 19.385520197451115,
 18.324989780783653,
 18.89291825145483,
 19.488332100212574,
 19.279757879674435,
 18.383467730134726,
 20.20944045484066,
 18.437771789729595,
 18.691356725990772,
 18.809736743569374,
 19.589019164443016,
 18.66381562501192,
 22.11755057424307,
 20.677578262984753,
 20.483208552002907,
 19.791884057223797,
 19.301412358880043,
 18.459284976124763,
 18.854777567088604,
 19.06963972747326,
 18.45663122832775,
 19.013088442385197,
 19.585248485207558,
 18.749309740960598,
 18.9384635835886,
 19.159833528101444,
 21.213976740837097,
 20.68718659877777,
 20.439529068768024,
 20.121621750295162,
 18.642522606998682,
 18.93931432068348,
 19.41828627884388,
 18.353571489453316,
 18.939943946897984,
 17.941476605832577,
 18.40239456295967,
 18.302602469921112,
 19.17604151368141,
 18.392440997064114,
 19.81928986310959,
 18.558114670217037,
 18.60763470083475,
 18.322977647185326,
 18.8971676081419,
 18.261985145509243,
 22.44919851049781,
 19.086355932056904,
 18.78621368855238,
 18.69442930072546,
 19.36983446031809,
 18.802575394511223,
 19.496502123773098,
 18.39374317973852,
 18.501954451203346,
 18.83871976286173,
 19.511209227144718,
 18.855346724390984,
 18.754793792963028,
 18.521114975214005,
 18.978332951664925,
 18.273710511624813,
 18.005694657564163,
 18.57561829686165,
 18.499602638185024,
 18.211635254323483,
 17.52161207050085,
 18.618972301483154,
 18.417613118886948,
 18.581233821809292,
 19.23391566425562,
 19.72324515134096,
 18.524751379154623,
 18.38544139545411,
 18.766720548272133,
 19.365905925631523,
 18.291696563363075,
 18.552598506212234,
 17.854719258844852,
 18.309855200350285,
 18.22171575576067,
 18.157440751791,
 18.450823694467545,
 18.43215185403824,
 19.10395280085504,
 18.73341454565525,
 18.207369446754456,
 17.609863981604576,
 18.85699074715376,
 20.389901101589203,
 21.189427256584167,
 20.02218723297119,
 18.743886444717646,
 20.16805689036846,
 19.142879158258438,
 18.702634550631046,
 18.31693896651268,
 17.90104714781046,
 18.470178559422493,
 18.17702117562294,
 18.452078871428967,
 18.803050875663757,
 18.784210063517094,
 18.088575860485435,
 17.651321932673454,
 17.9427403062582,
 18.140495359897614,
 18.43074558675289,
 17.745332427322865,
 17.491169799119234,
 17.65933609381318,
 18.015743479132652,
 18.384626477956772,
 17.778256729245186,
 18.980540186166763,
 18.637352772057056,
 17.578181624412537,
 18.39509680867195,
 18.601316206157207,
 18.89065845310688,
 18.17908474802971,
 18.775361351668835,
 18.074724078178406,
 19.76119653880596,
 24.809110961854458,
 20.21743393689394,
 19.3030214458704,
 18.511384405195713,
 17.993426613509655,
 18.35368800163269,
 18.89242108911276,
 18.210813902318478,
 18.19181916117668,
 17.88386544585228,
 17.744514659047127,
 18.20594785362482,
 18.05932030081749,
 18.602093666791916,
 17.79313502460718,
 17.81219893693924,
 18.120099671185017,
 19.944199196994305,
 18.25086972117424,
 18.361889585852623,
 20.47710433602333,
 19.03995256870985,
 18.537308789789677,
 19.858837462961674,
 18.164794899523258,
 18.77145268023014,
 17.65414777956903,
 18.2250504642725,
 18.716147765517235,
 19.297931112349033,
 18.040150851011276,
 18.73383954912424,
 17.701339915394783,
 17.62690931558609,
 17.919432617723942,
 18.69040387123823,
 17.95551265962422,
 17.861124731600285,
 18.63502413779497,
 17.486227974295616,
 17.88176341354847,
 19.139807552099228,
 18.07024420425296,
 17.55904222279787,
 17.543084733188152,
 19.118074245750904,
 18.71910537034273,
 18.00237262248993,
 19.013342954218388,
 18.50246860086918,
 17.361378982663155,
 17.657096210867167,
 17.776838552206755,
 18.071385256014764,
 17.371812030673027,
 18.749385185539722,
 17.787607330828905,
 18.625953063368797,
 18.849583633244038,
 19.210271324962378,
 18.381458088755608,
 18.232472486793995,
 17.835412427783012,
 17.44365318119526,
 18.637992784380913,
 17.583954487927258,
 18.287553295493126,
 18.43078427016735,
 17.218694742769003,
 17.5310168415308,
 18.10367016494274,
 17.78595209121704,
 18.617148101329803,
 24.560194201767445,
 23.937027484178543,
 20.013905830681324,
 18.495769001543522,
 18.4250253662467,
 18.379078179597855,
 18.217043660581112,
 18.536439463496208,
 17.923882842063904,
 18.86794652044773,
 17.428398232907057,
 17.54706570506096,
 17.66737088561058,
 17.71494323760271,
 17.327346958220005,
 18.799733098130673,
 18.207805685698986,
 17.504229061305523,
 17.457976050674915,
 17.89248848706484,
 17.763951800763607,
 17.712758496403694,
 17.69093870744109,
 17.959928587079048,
 18.835746429860592,
 17.8395382091403,
 18.322469972074032,
 17.808685697615147,
 17.39831894636154,
 17.154714815318584,
 17.549970537424088,
 17.000709298998117,
 17.63869959115982,
 18.491369493305683,
 18.2091708406806,
 18.233621075749397,
 18.521266885101795,
 18.768133841454983,
 17.792019203305244,
 17.785540871322155,
 18.427774051204324,
 17.673348605632782,
 18.121013708412647,
 18.72901331074536,
 18.472206510603428,
 17.92504369840026,
 17.923091769218445,
 21.67438594996929,
 18.173204437829554,
 17.963995218276978,
 18.009650573134422,
 18.48608322441578,
 18.724187575280666,
 17.641849860548973,
 18.127107582986355,
 17.805502086877823,
 17.68950305134058,
 17.552525468170643,
 18.456909209489822,
 18.47541034221649,
 21.255734607577324,
 18.468469716608524,
 18.162393428385258,
 17.90292187780142,
 20.32494557648897,
 18.40751842345344,
 17.766925387084484,
 17.422184340655804,
 17.76049192994833,
 17.374301817268133,
 17.529941461980343,
 18.475673906505108,
 17.453521476127207,
 19.274157628417015,
 20.165123268961906,
 17.33971268683672,
 17.664737723767757,
 17.348007008433342,
 18.814955167472363,
 17.474711377173662,
 17.398714661598206,
 18.55273177474737,
 17.720198467373848,
 17.69080437719822,
 17.368433378636837,
 23.283808633685112,
 19.191601306200027,
 19.02871559560299,
 17.988117948174477,
 17.84792321920395,
 18.238463290035725,
 17.028686463832855,
 18.483322955667973,
 16.77350101619959,
 18.241261661052704,
 18.538949705660343,
 17.861273001879454,
 17.828996039927006,
 17.51791925728321,
 17.426639571785927,
 17.05529372394085,
 17.48055111989379]
# %%
import torch
# model = TheModelClass(*args, **kwargs)
# model.load_state_dict(torch.load(PATH))
# model.eval()
#model = torch.load('/home/reinauer/Downloads/PersFormer_ORBIT5K_state_dict.pth', map_location=torch.device('cpu'))
# %%
